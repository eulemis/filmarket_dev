{"remainingRequest":"C:\\laragon\\www\\filmarket-dev\\node_modules\\babel-loader\\lib\\index.js!C:\\laragon\\www\\filmarket-dev\\node_modules\\ts-loader\\index.js??ref--13-2!C:\\laragon\\www\\filmarket-dev\\src\\utils\\http.ts","dependencies":[{"path":"C:\\laragon\\www\\filmarket-dev\\src\\utils\\http.ts","mtime":1633622426685},{"path":"C:\\laragon\\www\\filmarket-dev\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\filmarket-dev\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\laragon\\www\\filmarket-dev\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L2xhcmFnb24vd3d3L2ZpbG1hcmtldC1kZXYvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgc2Vzc2lvbiBmcm9tICdAL3N0b3JlL21vZHVsZXMvc2Vzc2lvbk1vZHVsZSc7CmltcG9ydCBzdG9yZSBmcm9tICdAL3N0b3JlJzsKdmFyIFVSTCA9ICdodHRwOi8vYXBpLmZpbGljYWJoLmNvbS9hcGkvdjEnOwp2YXIgaGVhZGVycyA9IHsKICAiQ29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iCn07CnZhciBodHRwID0gYXhpb3MuY3JlYXRlKHsKICBiYXNlVVJMOiBVUkwsCiAgaGVhZGVyczogaGVhZGVycwp9KTsKZXhwb3J0IGRlZmF1bHQgYXhpb3MuY3JlYXRlKHsKICBiYXNlVVJMOiAiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2FwaSIsCiAgaGVhZGVyczogewogICAgIkNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIgogIH0KfSk7CnZhciBpc0FscmVhZHlGZXRjaGluZ0FjY2Vzc1Rva2VuID0gZmFsc2U7Cmh0dHAuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGZ1bmN0aW9uIChjb25maWcpIHsKICBzdG9yZS5jb21taXQoJ2xvYWRpbmcnLCB0cnVlKTsgLy8gT3B0aW9uYWwgaGVhZGVycwoKICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ190b2tlbicpKSB7CiAgICB2YXIgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnX3Rva2VuJyk7CiAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gIkJlYXJlciAiLmNvbmNhdCh0b2tlbik7CiAgfQoKICByZXR1cm4gY29uZmlnOwp9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwp9KTsKaHR0cC5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKGZ1bmN0aW9uIChyZXNwb25zZSkgewogIHN0b3JlLmNvbW1pdCgnbG9hZGluZycsIGZhbHNlKTsKICBzdG9yZS5jb21taXQoJ2Vycm9ycycsIHt9KTsKICBzdG9yZS5jb21taXQoJ2Vycm9yJywgZmFsc2UpOwogIHJldHVybiByZXNwb25zZTsKfSwgLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShlcnJvcikgewogICAgdmFyIGNvbmZpZywgc3RhdHVzLCBvcmlnaW5hbFJlcXVlc3QsIGlzUmVmcmVzaE9rLCByZXRyeU9yaWdpbmFsUmVxdWVzdDsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29uc29sZS5sb2coJ0VSUk9SJyk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICBzdG9yZS5jb21taXQoJ2xvYWRpbmcnLCBmYWxzZSk7CiAgICAgICAgICAgIHN0b3JlLmNvbW1pdCgnZXJyb3JzJywgZXJyb3IucmVzcG9uc2UuZGF0YSB8fCB7CiAgICAgICAgICAgICAgIm5vbmUiOiBbZXJyb3IucmVzcG9uc2UuZGF0YV0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHN0b3JlLmNvbW1pdCgnZXJyb3InLCB0cnVlKTsKICAgICAgICAgICAgY29uZmlnID0gZXJyb3IuY29uZmlnLCBzdGF0dXMgPSBlcnJvci5yZXNwb25zZS5zdGF0dXM7CiAgICAgICAgICAgIG9yaWdpbmFsUmVxdWVzdCA9IGNvbmZpZzsKICAgICAgICAgICAgaXNSZWZyZXNoT2sgPSBmYWxzZTsKCiAgICAgICAgICAgIGlmICghKHN0YXR1cyA9PT0gNDAxKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGlzQWxyZWFkeUZldGNoaW5nQWNjZXNzVG9rZW4pIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlzQWxyZWFkeUZldGNoaW5nQWNjZXNzVG9rZW4gPSB0cnVlOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTM7CiAgICAgICAgICAgIHJldHVybiBzZXNzaW9uLmdldFJlZnJlc2hUb2tlbigpOwoKICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIGlzUmVmcmVzaE9rID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgaXNBbHJlYWR5RmV0Y2hpbmdBY2Nlc3NUb2tlbiA9IGZhbHNlOwoKICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgIGlmICghaXNSZWZyZXNoT2spIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHJ5T3JpZ2luYWxSZXF1ZXN0ID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgICAgICByZXNvbHZlKGh0dHAob3JpZ2luYWxSZXF1ZXN0KSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCByZXRyeU9yaWdpbmFsUmVxdWVzdCk7CgogICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgUHJvbWlzZS5yZWplY3QoZXJyb3IpKTsKCiAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjQ7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVqZWN0KGVycm9yKSk7CgogICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpKTsKZXhwb3J0IHsgaHR0cCwgVVJMLCBoZWFkZXJzIH07"},{"version":3,"sources":["C:\\laragon\\www\\filmarket-dev\\src\\utils\\http.ts"],"names":[],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport session from '@/store/modules/sessionModule';\r\nimport store from '@/store'\r\n\r\nconst URL  =  'http://api.filicabh.com/api/v1'\r\nconst headers =   {\r\n  \"Content-type\": \"application/json\"\r\n}\r\nconst http = axios.create({\r\n  baseURL: URL, headers\r\n});\r\n\r\nexport default axios.create({\r\n  baseURL: \"http://localhost:8080/api\",\r\n  headers: {\r\n    \"Content-type\": \"application/json\"\r\n  }\r\n});\r\n\r\nlet isAlreadyFetchingAccessToken = false;\r\n  \r\nhttp.interceptors.request.use( (config) => {\r\n  store.commit('loading',true);\r\n  // Optional headers\r\n  if (localStorage.getItem('_token')) {\r\n    const token = localStorage.getItem('_token');\r\n    config.headers.Authorization = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n\r\n}, (error) => {\r\n  return Promise.reject(error);\r\n});\r\n\r\n\r\nhttp.interceptors.response.use( (response) => {\r\n\r\n  store.commit('loading',false);\r\n  store.commit('errors',{});\r\n  store.commit('error',false);\r\n  return response;\r\n\r\n}, async (error: any) => {\r\n  console.log('ERROR')\r\n  console.log(error.response.data)\r\n  store.commit('loading',false);\r\n  store.commit('errors',error.response.data || { \"none\": [error.response.data]  });\r\n  store.commit('error',true);\r\n  const { config, response: { status } } = error;\r\n  const originalRequest = config;\r\n  let isRefreshOk: boolean = false;\r\n\r\n  if (status === 401) {\r\n    if (!isAlreadyFetchingAccessToken) {\r\n      isAlreadyFetchingAccessToken = true;\r\n      isRefreshOk = await session.getRefreshToken();\r\n      isAlreadyFetchingAccessToken = false;\r\n    }\r\n    if (isRefreshOk) {\r\n      const retryOriginalRequest = new Promise((resolve) => {\r\n          resolve(http(originalRequest));\r\n      });\r\n      return retryOriginalRequest; \r\n    } else {\r\n      return Promise.reject(error); \r\n    }\r\n  } else { \r\n   return Promise.reject(error);\r\n  }\r\n});\r\n\r\n\r\nexport { http, URL, headers};\r\n\r\n\r\n\r\n"],"sourceRoot":""}]}